<% content_for :page_title do %><h2>Challenge to Battle</h2><% end %>

<div class="box full">

<% form_for @challenge, :url => facebook_nested_url(facebook_pet_challenges_path(@pet)), :html => { :method => :post} do |f| %>	
<table class="comparison-table">
  <tbody>
  <tr>
	<th width="45%" colspan="2"><%= @challenge.attacker.name %></th>
	<td width="10%">challenges</td>
	<th width="45%" colspan="2"><%= @challenge.defender.name %></th>
  </tr>	
  <tr>
    <td rowspan="7"><%= avatar_image(@challenge.attacker,'large') %></td>
    <td><%= @challenge.attacker.breed.name %></td>
	<tr><td>Breed</td></tr>
    <td><%= @challenge.defender.breed.name %></td>
    <td rowspan="7"><%= avatar_image(@challenge.defender,'large') %></td>
  </tr>	
  <tr>
	<td><%= percentage_bar([@challenge.attacker.health,@challenge.defender.health]) %></td>
	<td><%= @challenge.attacker.health %></td>
	<tr><td>Health</td></tr>
	<td><%= @challenge.defender.health %></td>
	<td><%= percentage_bar([@challenge.defender.health,@challenge.attacker.health]) %></td>
  </tr>
  <tr>
	<td><%= percentage_bar([@challenge.attacker.endurance,@challenge.defender.endurance]) %></td>
	<td><%= @challenge.attacker.endurance %></td>
	<tr><td>Endurance</td></tr>
	<td><%= @challenge.defender.endurance %></td>
	<td><%= percentage_bar([@challenge.defender.endurance,@challenge.attacker.endurance]) %></td>
  </tr>	
  <tr>
	<td><%= percentage_bar([@challenge.attacker.power,@challenge.defender.power]) %></td>
	<td><%= @challenge.attacker.power %></td>
	<tr><td>Power</td></tr>
	<td><%= @challenge.defender.power %></td>
	<td><%= percentage_bar([@challenge.defender.power,@challenge.attacker.power]) %></td>
  </tr>
  <tr>
	<td><%= percentage_bar([@challenge.attacker.fortitude,@challenge.defender.fortitude]) %></td>
	<td><%= @challenge.attacker.fortitude %></td>
	<tr><td>Fortitude</td></tr>
	<td><%= @challenge.defender.fortitude %></td>
	<td><%= percentage_bar([@challenge.defender.fortitude,@challenge.attacker.fortitude]) %></td>
  </tr>
  <tr>
	<td><%= percentage_bar([@challenge.attacker.intelligence,@challenge.defender.intelligence]) %></td>
	<td><%= @challenge.attacker.intelligence %></td>
	<tr><td>Intelligence</td></tr>
	<td><%= @challenge.defender.intelligence %></td>
	<td><%= percentage_bar([@challenge.defender.intelligence,@challenge.attacker.intelligence]) %></td>
  </tr>
  <tr>
	<td><%= percentage_bar([@challenge.attacker.level_rank_count,@challenge.defender.level_rank_count]) %></td>
	<td><%= @challenge.attacker.level_rank_count %></td>
	<tr><td>Level</td></tr>
	<td><%= @challenge.defender.level_rank_count %></td>
	<td><%= percentage_bar([@challenge.defender.level_rank_count,@challenge.attacker.level_rank_count]) %></td>
  </tr>
  <tr>	
    <td colspan="2">
	  <% cell_table(@challenge.attacker.belongings.battle_ready) do |b,idx| %>
	  <td class='battle-gear'>
		<%= avatar_image(b.item,'tiny') %>
		<label><%= b.item.name %></label> <label class="em"><%= b.item.power %></label>
	  </td>
	  <% end %>
    </td>
	<td><%= @challenge.attacker.name %> likes to:<br /><%= @challenge.attacker.favorite_actions %></td>
	<tr><td>Favorite Actions</td></tr>
	<td><%= @challenge.defender.name %> likes to:<br /><%= @challenge.defender.favorite_actions %></td>
    <td colspan="2">
	  <% cell_table(@challenge.defender.belongings.battle_ready) do |b,idx| %>
	  <td class='battle-gear'>
		<%= avatar_image(b.item,'tiny') %>
		<label><%= b.item.name %></label> <label class="em"><%= b.item.power %></label>
	  </td>
	  <% end %>
    </td>
  </tr>
  <tr>
	<td colspan="3">	
	  <div>Your Pet's Battle Strategy</div>
	  <%= render_strategy_picker(f) %>
	</td>
    <th>Combat</th>
    <td colspan="3">
	  <div>Defender's Strategy</div>
	  <p class="em">
	    The defender will choose a strategy after they accept your challenge. Try to anticipate their actions
	    as and then act stronger!
	  </p>
    </td>
  </tr>
  <tr><td colspan="3">&nbsp;</td><td><%= submit_tag "Challenge"%></td><td colspan="3">&nbsp;</td></tr>	
</tbody>
</table>
<% end %>